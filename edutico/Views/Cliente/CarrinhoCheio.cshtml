@model IEnumerable<Carrinho>

@{
    ViewData["Title"] = "Carrinho Cheio";
    decimal subtotal = 0;
}

<section class="carrinhoCheio texto-simples">
    <div class="row padrao">
        <a href="#" class="Voltar">Voltar</a>
        <div class="justify-content-between d-flex">
            <p style=" font-family: 'Edutico'; font-size:23px; color:#426ef0">SEU CARRINHO</p>
        </div>
    </div>

    <div class="container d-flex col-10">
        <div class="produtos texto-simples col-7">
            @foreach (var itemCarrinho in Model)
            {
                // Calcula o total do item
                decimal totalItem = itemCarrinho.qtdProd * Convert.ToDecimal(itemCarrinho.produto.valorUnit);

                // Adiciona ao subtotal
                subtotal += totalItem;

                <div class="produto">
                    <div class="imgProd">
                        <img src="@Url.Content(itemCarrinho.produto.imgs.First().enderecoImg)" class="card-img-top rounded mt-1" alt="@itemCarrinho.produto.nomeProd" />
                    </div>
                    <div class="col-3">
                        <div class="info_prod_car">
                            <p>Produto</p>
                            <p id="glacial-bold">@itemCarrinho.produto.nomeProd</p>
                        </div>
                        <div class="info_prod_car">
                            <p>Quantidade:</p>
                            <p id="glacial-bold">@itemCarrinho.qtdProd</p>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="info_prod_car">
                            <p>Valor:</p>
                            <p id="glacial-bold">R$ @itemCarrinho.produto.valorUnit</p>
                        </div>
                        <div class="info_prod_car">
                            <p>Total:</p>
                            <p id="glacial-bold">R$ @totalItem</p>
                        </div>
                    </div>
                </div>
            }
        </div>

        <div class="col-4 mx-4">
            <div class="previa">
                <p class="previaTitulo">Previa</p>
                <hr />
                <div class="precoPrevia">
                    <p style="font-size:15px;">Entrega</p>
                    <p style="font-size:15px;">R$ 20,00</p> <!-- Taxa fixa -->
                </div>
                <div class="precoPreviaSub">
                    <p id="glacial-bold" style="font-size:15px;">Subtotal</p>
                    <p style="font-size:15px;">R$ @subtotal</p> <!-- Exibe o subtotal calculado -->
                </div>
                <hr />
                <div class="precoPreviaT">
                    <p id="glacial-bold" style="font-size:25px;">Total</p>
                    <p style="font-size:25px;">R$ @(subtotal + 20)</p> <!-- Total é o subtotal + taxa de entrega -->
                </div>

                <div class="Prazo" style="display: flex; align-items: center;">
                    <img src="~/imgs/reembolso.png" class="img-fluid" alt="Prazo" />
                    <div style="display: flex; flex-direction: column; margin-left: 10px;">
                        <p class="limite" style="margin: 0; display: inline;">Limite de 7 dias após a compra para reembolso do produto se solicitado. Saber mais.</p>
                    </div>
                </div>
                <button class="btn-primary">Prosseguir compra</button>
            </div>

            <div class="tipoPag">
                <p id="glacial-bold">Tipos de pagamentos</p>
                <div class="row">
                    <div class="col-md-6 pagMet">
                        <img src="~/imgs/tipoPagC.png" class="img-fluid" alt="cartão" />
                        <p id="glacial-bold">Cartão de credito</p>
                    </div>
                    <div class="col-md-6 pagMet">
                        <img src="~/imgs/tipoPagP.png" class="img-fluid" alt="pix" />
                        <p id="glacial-bold">PIX</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>